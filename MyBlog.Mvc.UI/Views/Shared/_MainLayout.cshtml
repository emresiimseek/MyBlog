<!DOCTYPE html>
<html lang="tr">


<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    @*<meta name="description" content="">*@
    <link href="~/Content/css/font-awesome.min.css" rel="stylesheet" />
    @*<meta name="author" content="TemplateMo">*@
    <script src="~/Scripts/jquery-3.5.1.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">

    <!-- Bootstrap core CSS -->
    <link href="~/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="~/assets/css/fontawesome.css">
    <link href="~/assets/css/templatemo-stand-blog.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/assets/css/owl.css">
    <link rel="stylesheet " href="~/assets/css/social-buttons.css" />
    <link href="~/assets/css/custom.css" rel="stylesheet" />


    @{
        string js = string.Empty;
        if (Session["user"] != null)
        {
            var id = Session["id"];

            js = "id=" + id;
        }

    }

    <style>
        .circular--portrait {
            position: relative;
            width: 100px;
            height: 100px;
            overflow: hidden;
            border-radius: 50%;
            margin-left: 20px;
            margin-bottom: 35px;
        }

            .circular--portrait img {
                width: 100%;
                height: auto;
            }

        #footer {
            /*height: 125px;*/
            bottom: 0px;
            /*left: 0px;*/
            /*right: 0px;*/
        }
    </style>

    <script>

        $(function () {
            @RenderSection("allblogpost", required: false)
            $('#txt_veri').on('keypress', function (e) {
                if (e.which === 13) {

                    //Disable textbox to prevent multiple submit
                    $(this).attr("disabled", "disabled");

                    var dat = $("#txt_veri").val();
                    $.ajax({
                        method: "GET",
                        url: "/Articles/GetArticles",
                        data: { veri: dat }
                    }).done(function (a) {
                        $("#main").html(a);
                        //$("#leftpanel").html(d);
                    });

                    //Enable the textbox again if needed.
                    $(this).removeAttr("disabled");
                }
            });

            $("#pop").click(function () {
                var id = null;

                @Html.Raw(js);
                $.ajax({
                    method: "POST",
                    url: "/Members/UserProfile",
                    data: { model: id}
                }).done(function (a) {


                    //if ($("#uName").val()== null) {

                    var maininput = document.createElement("DIV");
                    maininput.setAttribute("class", "col-sm-8");
                    maininput.setAttribute("id", "userd");
                    var val = document.createElement("DIV");
                    val.setAttribute("id", "val");
                    maininput.appendChild(val);
                    var inppp = document.createElement("INPUT");
                    inppp.setAttribute("type", "file");
                    inppp.setAttribute("id", "fileToUpload");
                    //inppp.setAttribute("style", "margin-top:110px;float:left;");
                    maininput.appendChild(inppp);




                        for (var i in a) {

                            if (i == "Profilephoto") {
                                var img = document.createElement("IMG");
                                img.setAttribute("src","/uploads/Profile/"+a[i]);
                                img.setAttribute("width", "100");
                                img.setAttribute("height", "150");
                                $("#pp").append(img);

                            }

                            if (i == "Name" ) {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "text");
                                inp.setAttribute("value", a[i]);
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "form-control");
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }
                            if (i == "Lastname") {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "text");
                                inp.setAttribute("value", a[i]);
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "form-control");
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }
                            if (i == "Username") {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "text");
                                inp.setAttribute("value", a[i]);
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "form-control");
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }

                            if (i == "Password") {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "password");
                                inp.setAttribute("value", a[i]);
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "form-control");
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }
                            if (i == "IsActive") {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "checkbox");
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "checkbox-inline");
                                inp.setAttribute("checked",a[i])
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }
                            if (i == "Email") {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "email");
                                inp.setAttribute("value", a[i]);
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "form-control");
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }
                            if (i == "ModifiedUsername") {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "text");
                                inp.setAttribute("value", a[i]);
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "form-control");
                                inp.setAttribute("style", "display:none")
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }
                            if (i == "Id") {
                                var inp = document.createElement("INPUT");
                                inp.setAttribute("type", "text");
                                inp.setAttribute("value", a[i]);
                                inp.setAttribute("id", "u" + i);
                                inp.setAttribute("class", "form-control");
                                inp.setAttribute("style", "display:none")
                                //$("#userd").append(inp);
                                maininput.appendChild(inp);
                            }

                    }
                    $("#userd").replaceWith(maininput);

                    //}
                    }).always(function () {

                        $('#userModal').modal('show')
                        $("#val").empty();

                    });
            });


            $(document).on('click', '.edit_data', function () {

                if (window.FormData == undefined)
                    alert("Error: FormData is undefined");

                else {
                    //var fileUpload = $("#fileToUpload").get(0).files;
                    //var files = fileUpload.files;

                    var files =$("#fileToUpload").get(0).files;
                    var fileData = new FormData();
                    fileData.append("file", files[0]);
                    fileData.append("Id", $("#uId").val());
                    //fileData.append(files[0].name, files[0]);

                    fileData.append("Name", $("#uName").val());
                    fileData.append("Lastname", $("#uLastname").val());
                    fileData.append("ModifiedOn", new Date(Date.now()));
                    fileData.append("ModifiedUsername", $("#uModifiedUsername").val());
                    fileData.append("Username", $("#uUsername").val());
                    fileData.append("Email", $("#uEmail").val());
                    fileData.append("IsActive", $("#uIsActive").prop("checked"));
                    fileData.append("ActivateGuid", $("#uActivateGuid").val());
                    fileData.append("Password", $('#uPassword').val());


                    $.ajax({
                        url: '/Members/UpdateUser',
                        type: 'post',
                        datatype: 'json',
                        contentType: false,
                        processData: false,
                        async: false,
                        data: fileData,
                        success: function (e) {
                            if (e['success'] == false) {
                                var errors = e['errors'];
                                displayValidationErrors(errors)
                            }
                            else {
                            //      var inp = document.createElement("INPUT");
                            //    inp.setAttribute("type", "email");
                            //    inp.setAttribute("value", a[i]);
                            //    inp.setAttribute("id", "u" + i);
                            //    inp.setAttribute("class", "form-control");
                            //    $("#val").append(inp);
                                displayValidationErrors("Kaydınız başarılı bir şekilde gerçekleşmiştir.")
                            }
                        }
                    });
                }
            });

            $("#form-submit").click(function () {
                var comment = new Object();
                comment.Text = $('#message').val();
                comment.UserId = $("#userId").val();
                comment.ArticleId = $("#articleId").val();
                $.ajax({
                    method: "POST",
                    url: "/Comments/AddComment",
                    data: JSON.stringify(comment),
                    contentType: "application/json",
                    success: function (d) {
                            $("#com").append(d);
                    }
                });

            });

            function displayValidationErrors(errors) {
                var $ul = $('div.validation-summary-valid.text-danger > ul');

                $ul.empty();
                $.each(errors, function (idx, errorMessage) {
                    $("#val").replaceWith('<li>' + errorMessage + '</li>');//try hear
                });
            }
        });
    </script>
</head>
<body>

    <!-- ***** Preloader Start ***** -->
    <div id="preloader">
        <div class="jumper">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <!-- ***** Preloader End ***** -->
    <!-- Header -->
    <header class="">
        <nav class="navbar navbar-expand-lg">
            <div class="container">
                <a class="navbar-brand logo_tagline" title="YAZILIM |TEKNOLOJİ|ARAŞTIRMA" href="/Home/index"><h2>M<em>.</em>Emre Şimşek</h2></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li id="home" class="nav-item active">
                            <a class="nav-link" href="/Home/index">
                                Anasayfa
                                <span class="sr-only">(current)</span>
                            </a>
                        </li>
                        <li id="about" class="nav-item">
                            <a class="nav-link" href="/About/about">Hakkımda</a>
                        </li>
                        <li id="article" class="nav-item">
                            <a class="nav-link" href="/Articles/ArticlesPage">Yazılar</a>
                        </li>
                        <li id="contact" class="nav-item">
                            <a class="nav-link" href="/Contact/ContactPage">İletişim</a>
                        </li>
                        </>

                        @{
                            User user = (User)Session["user"];
                        }
                        @if (user != null)
                        {
                            <li>
                         @Html.Partial("_ProfilePartial")
                            </li>
                            <li>
                                <div id="pop">

                                    @if (user != null)
                                    {
                                        <p title="Profilinizi görüntülemek için tıklayınız." style="text-transform:uppercase;margin-top:5px;">  <i class="fa fa-user-circle-o" aria-hidden="true"></i>  @(user.Name + " " + @user.Lastname) </p>

                                    }
                                </div>
                            </li>

                            <li>
                                <a href="/Login/SignOut">
                                    <i style="color:red; margin-top:12px;margin-left:5px;" class="fa fa-sign-out" aria-hidden="true"></i>
                                </a>
                            </li>
                        }
                        else
                        {
                            <li> <a style="margin-right:5px" class="btn btn-outline-warning my-2 my-sm-0 nav_brand" href="/Members/RegisterUser">Kaydol</a></li>

                            <li><a class="btn btn-outline-success" href="/Login/LoginPage">Giriş</a> </li>
                        }


                    </ul>
                </div>
            </div>
        </nav>
    </header>

    @RenderBody()






    <br /><br />

    <footer class="py-3 bg-dark" id="footer" style="margin-top:100px;">
        <div class="container">
            <p class="m-0 text-center text-white">Copyright &copy; Your Website 2020</p>
            <div class="social-buttons" style="text-align:center;">
                <a href=""><i class="fab fa-teamspeak"></i></a>
                <a href="https://twitter.com/emresimseka"><i class="fab fa-twitter"></i></a>
                <a href="https://www.instagram.com/emresimsekm/?hl=tr"><i class="fab fa-instagram"></i></a>
                <a href="#"><i class="fab fa-youtube"></i></a>
                <a href="https://www.linkedin.com/in/muhammed-emre-%C5%9Fim%C5%9Fek-14a676136/"><i class="fab fa-linkedin-in"></i></a>
            </div>
        </div>
        <!-- /.container -->
    </footer>

    <script src="~/vendor/jquery/jquery.min.js"></script>
    <script src="~/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>


    <!-- Additional Scripts -->
    <script src="~/assets/js/custom.js"></script>
    <script src="~/assets/js/owl.js"></script>
    <script src="~/assets/js/slick.js"></script>
    <script src="~/assets/js/isotope.js"></script>
    <script src="~/assets/js/accordions.js"></script>

    <script language="text/Javascript">

        cleared[0] = cleared[1] = cleared[2] = 0; //set a cleared flag for each field
        function clearField(t) {                   //declaring the array outside of the
            if (!cleared[t.id]) {                      // function makes it static and global
                cleared[t.id] = 1;  // you could use true and false, but that's more typing
                t.value = '';         // with more chance of typos
                t.style.color = '#fff';
            }
        }
    </script>

</body>
</html>
@RenderSection("js", required: false)